<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta charset="UTF-8">
<style type="text/css">
    body {
        font-family: "Arial", Helvetica, sans-serif;
        background-color: #000000;
        color:#c0c0c0;
    }
    /* Bright links that only underline when tracked */
    a:link      { color:#00ffff; text-decoration: none; }
    a:visited   { color:#00ffff; text-decoration: none; }
    a:hover     { color:#00ffff; text-decoration: underline; }
    a:active    { color:#20ffff; text-decoration: none; }
    .video_box, .video_box_full, .video_box_alt {
        vertical-align: middle;
        text-align: center;
        width:75%;
        height:auto;
        position: relative;
        margin-left: auto;
        margin-right: auto;
        background: transparent;
    }
    .video_box_full {
        width:100%;
        height:auto;
    }
    .video_box_alt {
        width:auto;
        height:100%;
    }
    .videoplayer, .videoplayer_full {
        z-index:0;
        width:100%;
        height:auto;
    }
    .videoplayer_alt {
        width:auto;
        height:100%;
    }
    .video_controls, .video_controls_bottom {
        display: table;
        padding: 0;
        margin: 0;
        z-index:1;
        line-height: 32px;
        vertical-align: middle;
        width: 100%;
        height: 32px;
        background: transparent;
    }
    .video_controls_bottom {
        position: fixed;
        left: 0px;
        bottom: 0px;
        width: 100%;
    }
    #video_controls_left, #video_controls_right {
        display: table-cell;
        text-decoration: none;
        white-space:nowrap;
        overflow: hidden;
        height: 32px;
        width: 100px;
    }
    #video_controls_right {
        right: 0;
    }
    #progress_bar {
        z-index:1;
        display: table-cell;
        position: relative;
        height: 32px;
        width: auto;
    }
    #progress_bar_bg {
        z-index:1;
        position: absolute;
        height: 32px;
        width: 100%;
        background-color: #000000;
        opacity: 0.33;
    }
    #progress_playing, #progress_text, #progress_text_total, #progress_text_title, #progress_clickme {
        color: #808080;
        position: absolute;
        white-space:nowrap;
        overflow: hidden;
        left: 0;
        top: 0;
        height: 32px;
        border: none;
    }
    #progress_playing {
        z-index:2;
        opacity: 0.25;
        background-color: #ff0000;
    }
    #progress_text, #progress_text_total, #progress_text_title {
        vertical-align: middle;
        left: 1%;
        width: 98%;
        height:32px;
        line-height: 32px;
    }
    #progress_text {
        text-align: left;
        z-index:3;
    }
    #progress_text_total {
        text-align: right;
        z-index:4;
    }
    #progress_text_title {
        text-align: center;
        z-index:5;
    }
    #progress_clickme {
        z-index:6;
        width:100%;
    }
    .title {
        clear: both;
        width:100%;
        color:#00ffff;
        font-size:40px;
        white-space:nowrap;
        /*text-align:center;*/
    }
    #playlist {
        padding-left:10pt;
    }
    .index_entry {
        color:#00ffff;
        font-size:28px;
        white-space:nowrap;
    }
    img.index_thumbnail {
        width:THUMB_SIZEpx;
        vertical-align:middle;
        padding-bottom:8px;
        padding-right:8px;
    }
    .folder_entry {
        color:#00c0c0;
        font-size:32;
        white-space:nowrap;
    }
    .info_text {
      color: #808080;
      font-size: 10px;
    }
    .center {
        text-align:center;
        margin: auto;
        width:50%;
    }
    .folder_icon {
        display: inline-block;
        background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAM1BMVEUAAAD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wC9Wq90AAAAEHRSTlMA758vD9+vP3+/T89fbx+PcBUV9QAAAQpJREFUWMPt10tuhDAQRdECDC7zSd/9rzYDm44jGoGrImXCnTHgCD0hZESenv6kYdXfxaHp/oVDWxPQH4EutADpCDC1Alv8aQHQRiBW16EDSFf1p4AMHXfaTgGZbwF6DojeAVJ+Zz4CEi/q6wf5BFxVPWL3f0BSTUAyAyoyASo9sNqAEZj3CwMQAL4cQAQ6cQAKJA+QN3QAeUM7UDa0A2VDO1A2tANlQztQNjQDr7KhGUhlQzNA2dAFqBeYvUAQEVmB3gaM+RO+j9EOTF5AvUD0AsEJjOIEJi+gXiB6geAExv1IBCwW4H0WBLAA6gWiFwg1kNoaqw0zYGjyAtp2rDy0VL8EQzQU5OndN+fTN/BxvmAlAAAAAElFTkSuQmCC) no-repeat;
        background-size:cover;
        height:32px;
        width:32px;
        /* Match text */
        filter: hue-rotate(120deg);
        -webkit-filter: hue-rotate(120deg);
        -moz-filter: hue-rotate(120deg);
        -ms-filter: hue-rotate(120deg);
        -o-filter: hue-rotate(120deg);
    }
    .button_format {
        vertical-align:middle;
        background: transparent;
        border: none !important;
        font-size:0;
        /* Grey-scale */
        filter: saturate(0) brightness(0.5);
        -webkit-filter: saturate(0) brightness(0.5);
        -moz-filter: saturate(0) brightness(0.5);
        -ms-filter: saturate(0) brightness(0.5);
        -o-filter: saturate(0) brightness(0.5);
    }
</style>

<title>TITLE_TEXT</title>

</head>

<body onload="PlayerInit();">
<div id='video_box' class='video_box' style="display:none;">
<video id="videoplayer" class='videoplayer' controls > <!-- Show controls now, or 'Silk' never will -->
    Get a <i>modern</i> browser that supports HTML5 Video.  If you see this, it doesn't, or it is disabled.<br/><br/>
    <a href="https://www.google.com/intl/en/chrome/browser/">Chrome</a><br/>
    <a href="http://www.mozilla.org/en-US/firefox/new/">Firefox</a><br/>
    <a href="http://windows.microsoft.com/en-us/internet-explorer/download-ie">IE, if your Windows version supports a new enough version.</a><br/>
    <a href="http://www.apple.com/safari/">Safari</a><br/>
    <a href="https://en.wikipedia.org/wiki/List_of_web_browsers">Others...</a><br/>
    <a href="http://www.w3schools.com/html/html5_video.asp">More info about compatibility...</a><br/>
</video>
<div id="video_controls" class='video_controls'>
    <div id="video_controls_left">
        <button id="bPrev"  class="button_format" type="button" tabindex='-1' title="Prev Video" onclick="javascript: return PlayPrev(); "><img width="32" height="32" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAM1BMVEUAAAD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wC9Wq90AAAAEHRSTlMAn1/P7w8fv38/30+vL2+PSCbmlAAAAVNJREFUWMPtltmygyAMQBFkE6j8/9deFXBpCUvudKYP5K2NOZo9hAwZMuQbojcReHM6+10srz0oXPZvznyQqWIuvTc5RbL3XhfM+Qq9w+yKmVU+4RXclBmVCpYKUIcgL/EbIYDanoEBu/P/AATnNy8tDhBz7CehMQAdUyQ1/IoCQNhgvtAD1gvgKkZOhRLtBSTnbWqSPkBynl3V2QMQU0wdvQe0GcDV/HC+F0CXN+f7ADrW7fLRmk2A0/lXpqPqALZG59fccGoApJbLj8dmwKwIFiBTAA0WQExMoXRIwPYz9T9HAgiHMtleyi5fSz3NdIZCIAFXKG4l1TlQPou6e6S9txViqD4bGzPWH6MFtRfuw00jV9s5XlUZYODlmgY8tPyODjascB+cKyYL4BefwueNhQHhRDkSXjzkGAhI5wtz9WPO5FVuklKq6pXHtRsn9ZAfkz8Vlyzt5B2tZgAAAABJRU5ErkJggg==" /></button>
        &nbsp;
        <button id="bPlay"  class="button_format" type="button" tabindex='-1' title="Playing" onclick="javascript: return TogglePause(); "><img width="32" height="32" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAM1BMVEUAAAD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wC9Wq90AAAAEHRSTlMAX3+fHw/fvz/vb8+Pr08vH6GT9QAAARVJREFUWMPt1kEWgjAMBNBogRYQzf1PK2pbUElopit9ZAvvL2YKDdExx/zpDMxDFdAxsw8VAD/HN5UAs2sqAe7PLQz4SAwoQKfuRXQnEJjb7GOaAQSoPfdYIQkgahxUyALMhAcKWQNEwV7IO0D2Qj4BcyHfgLGQDcBWyCZgKUQAygsRgdJCFKCsEBUoKUQHVoVMILAUIjx+PNWPXMyyB4EwxiquELCcJ/EVDWhTgBflOMpArnBSPwgRSOdw76sWgJzd7n9lEyjITgPaS0F2ClCWnQiUZicA6S9iuCTXQDMBF8sC5OycaVHIAHq5RiBlN5qv9ycAZPcGjDVbks9blsOWrATAm6IHs8vjwOzy3LwHN8xjfnfuxW4eLZUgAykAAAAASUVORK5CYII=" /></button>
        <button id="bPause" class="button_format" type="button" tabindex='-1' title="Paused"  onclick="javascript: return TogglePause(); "><img width="32" height="32" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAM1BMVEUAAAD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wC9Wq90AAAAEHRSTlMAnx9vD8/vvz9/3y9fj0+v5qtT8gAAANpJREFUWMPtlssSgzAIRdUQ8jKa///aGlIpdjpJu2m74K4YJGfA1Zkmjea78f7NwSU7V4pzeXn0Nlsodhu/z1juwXz2bOHY0fu1iKytN8vePNi/XEJX+FbXw2r6v2KvI+GY8aFWOx/gGdU/QixJi58903rm7HUB0EqQAPl9CHiuFaAABShAAQpQgAJ+D3ilOIuQuC4Ar5KFtYhVzYgKVdhiF0Bq5vwRx8JGwofhCEls6IsmSs9E2hyi7EX4XHWToGIaWj2btWWpBbblGca6DsZRjJxNgZImzT/mBkGiM2fKQSAUAAAAAElFTkSuQmCC" /></button>
        &nbsp;
    </div>
    <div id="progress_bar">
        <div id="progress_bar_bg"></div>
        <div id="progress_playing"></div>
        <div id="progress_text">00:00:00</div>
        <div id="progress_text_total">00:00:00</div>
        <div id="progress_text_title"></div>
        <div id="progress_clickme"></div>
    </div>
    <div id="video_controls_right">
        &nbsp;
        <button id="bFull"   class="button_format" type="button" tabindex='-1' title="Show Full Screen" onclick="javascript: return ToggleFullScreen();"><img width="32" height="32" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABABAMAAABYR2ztAAAAMFBMVEUAAAD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wDMmCVMAAAAD3RSTlMAvz+vzy9vD+/fXx+Pf0+lFBEHAAAAwUlEQVRIiWNgGAXDDjDZ////QxzO5Zn///9HBWQFLP+B4DOc+x7EbUBWwI+qIB/E/YChwB3OLcaiAIWLKUIdBcr/EUAImwJ/JAU/0BXw/l/A8B8ZgEWQQSgDmgKQCBoAiWIyRxWMKsCpQAkGMBWw9SegJTmQCBLgBKZhVAWcmMl+PpL8F2z5YrMgApjTIm9+UlJF4m9S0sdSgHyFc0uwlzAf4dz1GAo4QSJ/UBU4ICvgNgT67QCcywbkCRcwjAJqAgBkdxuIF1Cy5AAAAABJRU5ErkJggg==" /></button>
        <button id="bWindow" class="button_format" type="button" tabindex='-1' title="Exit Full Screen" onclick="javascript: return ToggleFullScreen();"><img width="32" height="32" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABABAMAAABYR2ztAAAAMFBMVEUAAAD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wDMmCVMAAAAD3RSTlMAvz/vr88vD48fn0/fX29Ww6FLAAAAu0lEQVRIx2NgGAXDDvDG/0cHhgXICur/YwIHZAX6WBQIkKhAAM1V+rRQoAL12yz7//+FsCmIh/qtH0h9xqYA5nl/EI1LwVegFam4FcC5A6bA/jOca4/Vm5vN4FwgU39AIosK0S0E56pgj25EOMR/HqyR9f+/klICiJOkhDvJ/Qeq0MGXJkGi63EpOA+SaIAo+IpNwRRBQUEJILsCSLvTIrKClFDBe5ILEAIK5mNR0ICsgEkQA0iMVg7UBQAW/EiNO7XmGwAAAABJRU5ErkJggg==" /></button>
        &nbsp;
        <button id="bSeq"   class="button_format" type="button" tabindex='-1' title="Sequential" onclick="javascript: return PlayListShuffle();"><img width="32" height="32" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAM1BMVEUAAAD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wC9Wq90AAAAEHRSTlMAD9+f7y/Pfz+/H19vj0+veCxEAAAAAOZJREFUWMPtlkkOgzAMRclAJobm/qetAzFDV9hGrVTyNwak94iixHLXtfx7Zl8zBhav856BwfcHPkeGINwh0GUHjEAQTw/UlKXfIhigGonAQ/UPFZSjnCSCCGBogkVgmP1gE2AlB5feBL8UjABOEgH2QrHAQlUSATaWJwoUgFYiQLIJllHH8QTrGWaPB3iLOILw2qarVWBjyXT5Trr8IaixiT5i9qd5sSc0s31C3d/05U0wy4LxfyrM9vSBbnBUvu5jRTj8EWLxG5a4PBpc4vJoyGweDFrGw022Mr4aBDwYXHYS/gt5AyyXH4pjNidaAAAAAElFTkSuQmCC" /></button>
        <button id="bRand"  class="button_format" type="button" tabindex='-1' title="Shuffled"   onclick="javascript: return PlayListSequential();"><img width="32" height="32" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAM1BMVEUAAAD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wC9Wq90AAAAEHRSTlMAD6/fv59ff+8/H0+Pzy9vOwKkCwAAAc1JREFUGBm1wQlu2zAAAMElxVPn/v+1teWkqdEUkBh0hv/jaH5nKlzU/F7jIv+Fi1T+pnKRT63yMNfU/I2LfNkJyTdcFH3a2DffZC7L2sLctK3LzH1BXdi07Qw5dGLRtjMm6krWlUGTdpJ2BqmBpJ1BKiQtDGo6s+rGoKiVWd06Q4q2QPYh1mPnvk2nhdU/tMoNc1Pz3OPmF+7ozYcK8xGTL9xRPfGbynUheooQej/qg8p1WU2lLyVOfuGyohZYfdO4LGmF7Cnlejp2rtq1warmY2bAqpmuVsZMupM1MSaoMGlnTNcNVAZ1TaAyqGsCNTCm6wSbLgxSZ7ImBk1aWNQ1MCTrFEhqKzMDZjUTok8tpVSflsBlUa3Qm2+mg4vCpKaZUGLzTxsX7c2HrQfoD/UpN22Bi+bkKR5959OqhcvK5JsYOLRyw15y88tB18hNpabNl0TXxKCuia6J27KmtVSNLLpym58qVSu3bX5YyJqOzk1Fram5BaKnFLgjqIXT0jwt3JI18jIvq9oCtyzqzIekbeemSQ9esradu1adOGW1c9us7jxktTBg0wxktTCiaIOsFoYEtRxqYVDWSS2MWnxaGTepmR+omvmR3vneL9LSKivqIfJ0AAAAAElFTkSuQmCC" /></button>
        &nbsp;
        <button id="bNext"  class="button_format" type="button" tabindex='-1' title="Next Video" onclick="javascript: PlayNext(); return false;"><img width="32" height="32" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAM1BMVEUAAAD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wD//wC9Wq90AAAAEHRSTlMA31+f7w8ffz+/ry+Pb89P5cCn5AAAAUZJREFUWMPtlrmahCAQhAu5Ghy13v9pNxB0DtGhN9gNrMSAj1+6+gDg1q1bfyQREd9YCzJebR8MSbrH4eLoaORiP4sOCRNJpnCy37sK4NFZY4H78wOYNDeOUAB0UwsQSZr1k04AbFoRSUZATgDJrIhjK74ARB+LUdHrAECwxYpBCQAkrYhZlABgKHHkoATA15S8WNEBAEL+tKILAMhcUipKwG6FDUrAZoVbregHAKGk1AxKACBms0IHAKZqRVYC4B9bo+oAWMyvAGM10qoAvnZn1JlY54P1qjRuORxVhbRV0aIq5Zo8F3XNND0FrwA8FbBmHry0UD/grYm7Ae9jpBPwOci6ADY3b5XvAGzfa/UXwHIFyK1HxkDSDZJJ5jZgbj9zwn7GqQU4Dr7Kbi+IoxjHdvD7mHeNDK8ECbjSmFPKC27d+mf6AUwkLKIyJCOKAAAAAElFTkSuQmCC" /></button>
    </div>
</div>
</div>
<div id="title" class="title"><img class="folder" />TITLE_TEXT</div>
<div id="playlist">

<!-- 
    These definitions are sought out in this file, and used to replace the 
    'INDEXES_HERE' with files and folders 
-->

<!-- A movie file link with thumbnail -->

<!--INDEX_FILE
<div class="index_entry" title="Play MEDIA_TITLE" path="MEDIA_PATH" style='FILE_STYLE' >
    <a href="" onclick="javascript: PlayMedia(this.parentNode.getAttribute('path')); return false;" >
    <img class="index_thumbnail" src="MEDIA_IMAGE" />MEDIA_TITLE</a>
</div>
-->

<!-- A movie file link with no thumbnail -->

<!--INDEX_FILE_NOTHUMB
<div class="index_entry" title="Play MEDIA_TITLE" path="MEDIA_PATH" style='FILE_STYLE' >
    <a href="" onclick="javascript: PlayMedia(this.parentNode.getAttribute('path')); return false;" >MEDIA_TITLE</a>
</div>
-->

<!-- A folder -->

<!--INDEX_INDEX
<br/><a class="folder_entry" title="Browse FOLDER_TITLE" style='FOLDER_STYLE' href="FOLDER_PATH" ><div class="folder_icon"></div>FOLDER_TITLE</a>
-->

<!--INDEXES_HERE-->

</div>
<br/>
<div class="info_text">
    <a href="https://github.com/pingnak/videowebscript">Generated by VideoWebScript</a>
</div>

<script type="text/javascript">
var bShuffle = false;
var playlist;
var now_playing = null;
var video_box;
var video;
var video_controls;
var bPause;
var bPlay;
var bSeq;
var bRand;
var bPrev;
var bNext;
var progress_bar;
var progress_playing;
var progress_text;
var progress_text_total;
var progress_text_title;
var progress_clickme;
var bFullscreenEnabled = document.bFullscreenEnabled || document.webkitFullscreenEnabled || document.mozFullScreenEnabled || document.msFullscreenEnabled;
var bFull;
var bWindow;
var mouseTimeout = -1;
var resizeTimeout = -1;
var browserWidth;
var browserHeight;

/* If no full screen, or some kinda 'mobile' browser that ignores all the rules, use the native controls */
var bUseNativeControls = !bFullscreenEnabled || /Android|Silk|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

/** Press pause/play button */
function TogglePause()
{
    if( 0 == video.readyState )
        PlayMedia();
    else if( video.paused )
        video.play();
    else
        video.pause();
    return false;
}

/** When video is paused, change to show playing icon */
function ShowPaused()
{
    if( bUseNativeControls )
        return;
    bPlay.style.display = video.paused ? 'none' : '';
    bPause.style.display  = video.paused ? '' : 'none';
    return false;
}

/** See if video is not full-screen */
function VideoIsFullScreen()
{
    var fullscreenElement = document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement || document.msFullscreenElement;
    return video_box == fullscreenElement;
}

/** Press full-screen button */
function ToggleFullScreen()
{
    if( VideoIsFullScreen() )
        ExitFullscreen();
    else
        EnterFullscreen();
    return false;
}


/** Enter full screen mode */
function EnterFullscreen()
{
    if(video_box.requestFullscreen) 
    {
        video_box.requestFullscreen();
    }
    else if(video_box.mozRequestFullScreen) 
    {
        video_box.mozRequestFullScreen();
    } 
    else if(video_box.webkitRequestFullscreen) 
    {
        video_box.webkitRequestFullscreen();
    }
    else if(video_box.msRequestFullscreen) 
    {
        video_box.msRequestFullscreen();
    }
}

/** Exit full screen mode */
function ExitFullscreen() 
{
    if(document.ExitFullscreen) 
    {
        document.ExitFullscreen();
    }
    else if(document.mozCancelFullScreen) 
    {
        document.mozCancelFullScreen();
    } 
    else if(document.webkitExitFullscreen) 
    {
        document.webkitExitFullscreen();
    }
    else if(document.msExitFullscreen)
    {
        document.msExitFullscreen();
    }
}


/** Check to see if player overflows, and fix it*/
function CheckAspect()
{
    if( VideoIsFullScreen() )
    {
        if( video.clientHeight > screen.availHeight )
        {
            video_box.className = 'video_box_alt';
            videoplayer.className = 'videoplayer_alt';
        }
        else if( video.clientWidth > screen.availWidth )
        {
            video_box.className = 'video_box_full';
            videoplayer.className = 'videoplayer_full';
        }
    }
}

/** Format seconds to hh:mm:ss */
function hhmmss(t)
{
    if( isNaN(t) )
        return "00:00:00";     /* " My syntax highlighter chokes over colons in strings */
        
    var ss = Math.floor(t % 60);
    var mm = Math.floor((t / 60) % 60);
    var hh = Math.floor(t / 3600);
    return '' + ((hh < 10) ? '0'+hh : hh) +':'+((mm < 10) ? '0'+mm : mm)+':'+((ss < 10) ? '0'+ss : ss); 
}
/** Update progress */
function UpdateTime()
{   
    progress_playing.style.width = (100*video.currentTime/video.duration)+'%';
    progress_text.innerHTML = hhmmss(video.currentTime);
    progress_text_total.innerHTML = hhmmss(video.duration);
    return false;
}
/** Refresh play time */
function RefreshProgress(seconds)
{
    progress_text.innerHTML = hhmmss(seconds);
    progress_text_total.innerHTML = hhmmss(video.duration);
    if( isNaN(video.duration) || video.duration < 1 )
    {
        progress_playing.style.width = '0%';
    }
    else
    {
        progress_playing.style.width = (100*seconds/video.duration)+'%';
    }
}

/** 
 One of the reasons I loathe 'web technolog'.  
 Half a dozen kinds of 'position' on an event, according  
 to what browser.
 http://www.kirupa.com/html5/getting_mouse_click_position.htm
 */
function getClickPosition(e) {
    var parentPosition = getPosition(e.currentTarget);
    var xPosition = e.clientX - parentPosition.x;
    var yPosition = e.clientY - parentPosition.y;
    return { x: xPosition, y: yPosition };
}
/** Get position of element, on-screen */
function getPosition(element) {
    var xPosition = 0;
    var yPosition = 0;
    var elementcurr = element; 
    while (elementcurr) {
        xPosition += (elementcurr.offsetLeft - elementcurr.scrollLeft + elementcurr.clientLeft);
        yPosition += (elementcurr.offsetTop - elementcurr.scrollTop + elementcurr.clientTop);
        elementcurr = elementcurr.offsetParent;
    }
    return { x: xPosition, y: yPosition, w:element.clientWidth, h:element.clientHeight };
}

/** Convert mouse position to time */
function getProgressFromMouse(e)
{
    var pt = getClickPosition(e);
    var fraction = pt.x/progress_clickme.clientWidth;
    return fraction;
}
/** Seek to clicked time */
function ProgressClick(e)
{
    var fraction = getProgressFromMouse(e);
    var time= video.duration * fraction;
    video.currentTime = time;
}
/** Mouse entered progress; disable time updates */
function ProgressIn(e)
{
    ProgressTrackMouse(e);
    video.removeEventListener( 'timeupdate', UpdateTime );
}
/** Mouse exited progress; enable time updates */
function ProgressOut(e)
{
    UpdateTime();
    video.addEventListener( 'timeupdate', UpdateTime );
}
/** Update progress bar and time with mouse motion */
function ProgressTrackMouse(e)
{   /* Keep progress stamps from stomping on my tracking */
    var fraction = getProgressFromMouse(e);
    var time= video.duration * fraction;
    RefreshProgress(time);
}

/** We should know how big&long the video is, so we can update it*/
function UpdateMeta()
{
    UpdateTime();
    OnResize();
}

/**
 * Set things up, when the page loads
**/
function MouseTimeout()
{
    if( VideoIsFullScreen() )
    {
        video_controls.style.visibility = 'hidden';
        video_box.style.cursor = 'none';
    }
    else
    {
        video_controls.style.visibility = '';
        video_controls.style.display="table";
    }
    mouseTimeout = -1;
}

/** Mouse moved - */
function MouseMoved()
{
    if( VideoIsFullScreen() )
    {
        video_controls.style.visibility = '';
        if( -1 != mouseTimeout )
            clearTimeout(mouseTimeout);
        mouseTimeout = setTimeout( MouseTimeout, 3000 );
        video_box.style.cursor = '';
    }
    return true;
}

/**
 * Set things up, when the page loads
**/
function PlayerInit()
{
    video_box = document.getElementById("video_box");
    video_box.style.display = 'none';

    video = document.getElementById("videoplayer");
    video_controls = document.getElementById("video_controls");

    bPause= document.getElementById("bPause");
    bPlay = document.getElementById("bPlay");
    bFull = document.getElementById("bFull");
    bWindow=document.getElementById("bWindow");
    bPrev = document.getElementById("bPrev");
    bSeq  = document.getElementById("bSeq");
    bRand = document.getElementById("bRand");
    bNext = document.getElementById("bNext");
    progress_bar = document.getElementById("progress_bar");
    progress_text = document.getElementById("progress_text");
    progress_text_total = document.getElementById("progress_text_total");
    progress_text_title = document.getElementById("progress_text_title");
    progress_playing = document.getElementById("progress_playing");
    progress_clickme = document.getElementById("progress_clickme");

    if( bUseNativeControls )
    {
        /* If full-screen is unavailable to code, stick to native controls */
        video.setAttribute("controls",true);
        video_controls.style.display = 'none';
    }
    else
    {
        /* Had to add a layer on top of progress bar, to click */
        progress_clickme.addEventListener( 'mousemove', ProgressTrackMouse );    
        progress_clickme.addEventListener( 'click', ProgressClick );
        progress_clickme.addEventListener( 'mouseover', ProgressIn );     
        progress_clickme.addEventListener( 'mouseout', ProgressOut ); 
    
        video.addEventListener( 'playing', ShowPaused );
        video.addEventListener( 'pause', ShowPaused );
        video.addEventListener( 'timeupdate', UpdateTime );
        video.addEventListener( 'loadedmetadata', UpdateMeta );

        window.addEventListener( 'OnResize', OnResize );
        window.addEventListener( 'fullscreenchange', OnResize );
        window.addEventListener( 'webkitfullscreenchange', OnResize );
        window.addEventListener( 'mozfullscreenchange', OnResize );
        window.addEventListener( 'MSFullscreenChange', OnResize );
    }

    MakePlaylist();
    OnResizeNow();
    bNext.setAttribute( 'title', "Next: " + TitleFromPath( WhatNext() ) );
    bPrev.setAttribute( 'title', "Prev: " + TitleFromPath( WhatPrev() ) );

    var params = window.location.href.split('?');
    if( 2 == params.length )
    {   /* If we have '?title.mp4' that's the video in this folder, to play */
        PlayMedia(decodeURI(params[1]));
    }
}

/** Window changed: Organize and update controls */
function OnResize()
{
    // Because some browsers don't have this figured out yet, even though they call me
    if( -1 != resizeTimeout )
        clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(OnResizeNow,30);
}
function OnResizeNow()
{
    browserWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
    browserHeight= window.innerHeight|| document.documentElement.clientHeight|| document.body.clientHeight;
    if( !bUseNativeControls )
    {   // Sort out full versus windowed playbacl
        if( video.hasAttribute("controls") )
            video.removeAttribute("controls");
        if( VideoIsFullScreen() )
        {
            bWindow.style.display="";
            bFull.style.display="none";
            video_box.className = 'video_box_full';
            video_controls.className = 'video_controls_bottom';
            videoplayer.className = 'videoplayer';
            // Once we re-render, check video aspect, and adjust
            setTimeout(CheckAspect,30);
        }
        else
        {
            bWindow.style.display="none";
            bFull.style.display="";
            video_box.className = 'video_box';
            videoplayer.className = 'videoplayer';
            video_controls.className = 'video_controls';
            video_controls.style.display="table";
            if( -1 != mouseTimeout )
                clearTimeout(mouseTimeout);
            video_box.style.cursor = '';
        }
    }
    
    return false;
}

/*
 * Play a video
 * http://www.w3.org/2010/05/video/mediaevents.html
 */
function PlayMedia(video_path)
{   // Setting attributes blows up 
    if(typeof(video_path)==='undefined')
    {
        video_path = playlist[0].getAttribute('path');
    }
    now_playing = video_path;
    if( 'undefined' == typeof(now_playing) )
    {
        progress_text_title.innerHTML = '';
        video_box.style.display = 'none';
        video_box.removeEventListener( 'mousemove', MouseMoved );
        return;
    }
    setTimeout(function() { PlayMedia2(video_path) }, 10);
    OnResizeNow();
    bNext.setAttribute( 'title', "Next: " + TitleFromPath( WhatNext() ) );
    bPrev.setAttribute( 'title', "Prev: " + TitleFromPath( WhatPrev() ) );
    ShowPaused();
    return false;
}

/** Setting attributes kills the video... so let the stack unwind and start it second */
function PlayMedia2(video_path)
{
    video_box.style.display = '';

    var video_type='video/'+now_playing.split('.').pop();
    video.setAttribute("type",video_type);
    video.setAttribute("src",now_playing);
    video.load();
    video.play();
    video.addEventListener( "ended", PlayNext );

    // Show title
    progress_text_title.innerHTML = TitleFromPath(now_playing);

    // Show video
    window.scrollTo(0,0);
    
    video_box.addEventListener( 'mousemove', MouseMoved );
    
    // Tell display to come back up, between titles
    UpdateTime();
    MouseMoved();
}

/** Make a play list from title links */
function MakePlaylist()
{
    var collection = document.getElementsByClassName("index_entry");
    var array = new Array();
    var i;
    for( i = 0; i < collection.length; ++i )
    {
        array.push(collection[i]);
    }
    bRand.style.display = 'none';
    bSeq.style.display  = '';
    bShuffle = false;
    playlist = array;
}

/** Shuffle a play list */
function PlayListSequential()
{
    MakePlaylist();
    bRand.style.display = 'none';
    bSeq.style.display  = '';
    return PlayMedia();
}

/** Shuffle a play list */
function PlayListShuffle()
{
    ArrayShuffle(playlist);
    ArrayShuffle(playlist);
    ArrayShuffle(playlist);
    bRand.style.display = '';
    bSeq.style.display  = 'none';
    bShuffle = true;
    return PlayMedia();
}
/**
 * Shuffle an array
 * @param array Array to shuffle in-place
 * @return Array passed in
**/
function ArrayShuffle(array)
{
    var ri;
    var tmp;
    var i = array.length;
    while( i-- )
    {
        ri = Math.floor(Math.random() * array.length);
        tmp = array[i];
        array[i] = array[ri];
        array[ri] = tmp;
    }
    return array;
}
/** Get index of currently playing media */
function IndexPlaying()
{
    var i = playlist.length;
    while( 0 <= --i )
    {
        if( playlist[i].getAttribute('path') == now_playing )
            return i;
    }
    return -1;
}
/** Play the previous one */
function PlayPrev()
{
    PlayMedia(WhatPrev());
    return false;
}
/** Play the next one */
function PlayNext()
{
    PlayMedia(WhatNext());
    return false;
}
/** What will play previous */
function WhatPrev()
{
    var i = IndexPlaying() - 1;
    if( i < 0 )
    {
        i = playlist.length-1;
    }
    var path = playlist[i].getAttribute('path');
    return path;
}
/** Play the next one */
function WhatNow()
{
    var i = IndexPlaying();
    var path = playlist[i].getAttribute('path');
    return path;
}
/** What will play next */
function WhatNext()
{
    var i = IndexPlaying() + 1;
    if( i >= playlist.length )
    {
        i = 0;
    }
    var path = playlist[i].getAttribute('path');
    return path;
}
/** Turn video URI into title text */
function TitleFromPath(path)
{
    var titletext = decodeURI(path);
    titletext = titletext.substring(titletext.lastIndexOf('/')+1);
    titletext = titletext.substring(0,titletext.lastIndexOf('.'));
    return titletext;
}
</script>

</body>
</html>
